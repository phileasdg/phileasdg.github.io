<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Graphical iteration in R - Phileas Dazeley-Gaist</title><meta name="description" content="What is graphical iteration? Graphical iteration is one graphical way to visualise the&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-K13VH578CQ"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-K13VH578CQ' );</script><link rel="canonical" href="https://phileasdg.github.io/phileas-dazeley-gaist/graphical-iteration-in-r/"><link rel="alternate" type="application/atom+xml" href="https://phileasdg.github.io/phileas-dazeley-gaist/feed.xml"><link rel="alternate" type="application/json" href="https://phileasdg.github.io/phileas-dazeley-gaist/feed.json"><meta property="og:title" content="Graphical iteration in R"><meta property="og:image" content="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/staircase-diagram.png"><meta property="og:image:width" content="1016"><meta property="og:image:height" content="729"><meta property="og:site_name" content="Phileas Dazeley-Gaist"><meta property="og:description" content="What is graphical iteration? Graphical iteration is one graphical way to visualise the&hellip;"><meta property="og:url" content="https://phileasdg.github.io/phileas-dazeley-gaist/graphical-iteration-in-r/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@phileasdg"><meta name="twitter:title" content="Graphical iteration in R"><meta name="twitter:description" content="What is graphical iteration? Graphical iteration is one graphical way to visualise the&hellip;"><meta name="twitter:image" content="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/staircase-diagram.png"><link rel="stylesheet" href="https://phileasdg.github.io/phileas-dazeley-gaist/assets/css/style.css?v=ff30ce3ac4c3be676e9c9a0dc5db8575"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://phileasdg.github.io/phileas-dazeley-gaist/graphical-iteration-in-r/"},"headline":"Graphical iteration in R","datePublished":"2022-08-12T08:15","dateModified":"2022-08-12T08:15","image":{"@type":"ImageObject","url":"https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/staircase-diagram.png","height":729,"width":1016},"description":"What is graphical iteration? Graphical iteration is one graphical way to visualise the&hellip;","author":{"@type":"Person","name":"Phileas Dazeley-Gaist","url":"https://phileasdg.github.io/phileas-dazeley-gaist/authors/phileas-dazeley-gaist/"},"publisher":{"@type":"Organization","name":"Phileas Dazeley-Gaist"}}</script><a hidden rel="me" href="https://mathstodon.xyz/@phileasdg">Mastodon</a></head><body><header class="header" id="js-header"><a href="https://phileasdg.github.io/phileas-dazeley-gaist/" class="logo">Phileas Dazeley-Gaist</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/" target="_self">Home</a></li><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/a-few-words-about-me/" target="_self">About</a></li><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/resume-cv/" target="_self">Resume / CV</a></li><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/inquiries/" target="_self">Inquiries</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://phileasdg.github.io/phileas-dazeley-gaist/tags/programming/" class="post__maintag">Programming</a><h1 class="post__title">Graphical iteration in R</h1><div class="post__meta"><div class="post__author">By <a href="https://phileasdg.github.io/phileas-dazeley-gaist/authors/phileas-dazeley-gaist/" class="invert" rel="author" title="Phileas Dazeley-Gaist">Phileas Dazeley-Gaist</a></div><time datetime="2022-08-12T08:15">August 12, 2022</time></div></header><figure class="post__featured-image"><img src="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/staircase-diagram.png" srcset="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/staircase-diagram-xs.png 300w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/staircase-diagram-sm.png 480w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/staircase-diagram-md.png 768w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/staircase-diagram-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="729" width="1016" alt=""></figure><div class="post__inner"><div class="post__entry"><h2><span data-offset-key="3bl4a-0-0">What</span><span data-offset-key="3bl4a-1-0"> is</span><span data-offset-key="3bl4a-2-0"> graphical</span><span data-offset-key="3bl4a-3-0"> iteration</span><span data-offset-key="3bl4a-4-0">?</span></h2><p><span data-offset-key="3bl4a-23-0">Graph</span><span data-offset-key="3bl4a-24-0">ical</span><span data-offset-key="3bl4a-25-0"> iteration</span><span data-offset-key="3bl4a-26-0"> is</span><span data-offset-key="3bl4a-27-0"> one</span><span data-offset-key="3bl4a-28-0"> graphical</span><span data-offset-key="3bl4a-29-0"> way</span><span data-offset-key="3bl4a-30-0"> to</span><span data-offset-key="3bl4a-31-0"> visual</span><span data-offset-key="3bl4a-32-0">ise</span><span data-offset-key="3bl4a-33-0"> the</span><span data-offset-key="3bl4a-34-0"> orbits</span><span data-offset-key="3bl4a-35-0"> of</span><span data-offset-key="3bl4a-36-0"> a</span><span data-offset-key="3bl4a-37-0"> function</span><span data-offset-key="3bl4a-38-0"> for</span><span data-offset-key="3bl4a-39-0"> different</span><span data-offset-key="3bl4a-40-0"> initial</span><span data-offset-key="3bl4a-41-0"> conditions</span><span data-offset-key="3bl4a-42-0">.</span><span data-offset-key="3bl4a-43-0"> The</span><span data-offset-key="3bl4a-44-0"> main</span><span data-offset-key="3bl4a-45-0"> advantages</span><span data-offset-key="3bl4a-46-0"> of</span><span data-offset-key="3bl4a-47-0"> graphical</span><span data-offset-key="3bl4a-48-0"> iteration</span><span data-offset-key="3bl4a-49-0"> over</span><span data-offset-key="3bl4a-50-0"> other</span><span data-offset-key="3bl4a-51-0"> ways</span><span data-offset-key="3bl4a-52-0"> to</span><span data-offset-key="3bl4a-53-0"> visual</span><span data-offset-key="3bl4a-54-0">ise</span><span data-offset-key="3bl4a-55-0"> function</span><span data-offset-key="3bl4a-56-0"> orbits</span><span data-offset-key="3bl4a-57-0"> are</span><span data-offset-key="3bl4a-58-0"> that</span><span data-offset-key="3bl4a-59-0"> graphical</span><span data-offset-key="3bl4a-60-0"> iteration</span><span data-offset-key="3bl4a-61-0"> provides</span><span data-offset-key="3bl4a-62-0"> a</span><span data-offset-key="3bl4a-63-0"> visual</span><span data-offset-key="3bl4a-64-0">isation</span><span data-offset-key="3bl4a-65-0"> of</span><span data-offset-key="3bl4a-66-0"> the</span><span data-offset-key="3bl4a-67-0"> orbits</span><span data-offset-key="3bl4a-68-0"> as</span><span data-offset-key="3bl4a-69-0"> a</span><span data-offset-key="3bl4a-70-0"> trajectory</span><span data-offset-key="3bl4a-71-0"> on</span><span data-offset-key="3bl4a-72-0"> the</span><span data-offset-key="3bl4a-73-0"> plot</span><span data-offset-key="3bl4a-74-0"> of</span><span data-offset-key="3bl4a-75-0"> the</span><span data-offset-key="3bl4a-76-0"> function</span><span data-offset-key="3bl4a-77-0"> being</span><span data-offset-key="3bl4a-78-0"> iter</span><span data-offset-key="3bl4a-79-0">ated</span><span data-offset-key="3bl4a-80-0">.</span><span data-offset-key="3bl4a-81-0"> This</span><span data-offset-key="3bl4a-82-0"> can</span><span data-offset-key="3bl4a-83-0"> give</span><span data-offset-key="3bl4a-84-0"> insights</span><span data-offset-key="3bl4a-85-0"> into</span><span data-offset-key="3bl4a-86-0"> the</span><span data-offset-key="3bl4a-87-0"> behaviour</span><span data-offset-key="3bl4a-88-0"> of</span><span data-offset-key="3bl4a-89-0"> the</span><span data-offset-key="3bl4a-90-0"> orbits</span><span data-offset-key="3bl4a-91-0"> that</span><span data-offset-key="3bl4a-92-0"> might</span><span data-offset-key="3bl4a-93-0"> not</span><span data-offset-key="3bl4a-94-0"> be</span><span data-offset-key="3bl4a-95-0"> apparent</span><span data-offset-key="3bl4a-96-0"> from</span><span data-offset-key="3bl4a-97-0"> other</span><span data-offset-key="3bl4a-98-0"> ways</span><span data-offset-key="3bl4a-99-0"> of</span><span data-offset-key="3bl4a-100-0"> visual</span><span data-offset-key="3bl4a-101-0">ising</span><span data-offset-key="3bl4a-102-0"> the</span><span data-offset-key="3bl4a-103-0"> orbits</span><span data-offset-key="3bl4a-104-0">.</span><span data-offset-key="3bl4a-105-0"> It</span><span data-offset-key="3bl4a-106-0"> is</span><span data-offset-key="3bl4a-107-0"> another</span><span data-offset-key="3bl4a-108-0"> way</span><span data-offset-key="3bl4a-109-0"> to</span><span data-offset-key="3bl4a-110-0"> conceptual</span><span data-offset-key="3bl4a-111-0">ise</span><span data-offset-key="3bl4a-112-0"> the</span> <span data-offset-key="3bl4a-114-0">behaviour</span><span data-offset-key="3bl4a-115-0"> of</span><span data-offset-key="3bl4a-116-0"> orbits</span><span data-offset-key="3bl4a-117-0">.</span></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/graphical_iteration.png" alt="graphical iteration illustration " width="720" height="536" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical_iteration-xs.png 300w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical_iteration-sm.png 480w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical_iteration-md.png 768w"><figcaption>Graphical iteration illustration from https://www.mathscard.co.uk/online/numerical-methods/</figcaption></figure><h2><span data-offset-key="3bl4a-120-0">How</span><span data-offset-key="3bl4a-121-0"> does</span><span data-offset-key="3bl4a-122-0"> graphical</span><span data-offset-key="3bl4a-123-0"> iteration</span><span data-offset-key="3bl4a-124-0"> work</span><span data-offset-key="3bl4a-125-0">?</span></h2><p><strong>A step by step guide:</strong></p><ol><li><span data-offset-key="3bl4a-136-0">Choose</span><span data-offset-key="3bl4a-137-0"> a</span><span data-offset-key="3bl4a-138-0"> function</span><span data-offset-key="3bl4a-139-0"> to</span><span data-offset-key="3bl4a-140-0"> iter</span><span data-offset-key="3bl4a-141-0">ate</span><span data-offset-key="3bl4a-142-0">,</span><span data-offset-key="3bl4a-143-0"> for</span><span data-offset-key="3bl4a-144-0"> example</span><span data-offset-key="3bl4a-145-0">,</span><span data-offset-key="3bl4a-146-0"> the</span><span data-offset-key="3bl4a-147-0"> function</span><span data-offset-key="3bl4a-148-0"> f</span><span data-offset-key="3bl4a-149-0">(</span><span data-offset-key="3bl4a-150-0">x</span><span data-offset-key="3bl4a-151-0">)</span><span data-offset-key="3bl4a-152-0"> =</span><span data-offset-key="3bl4a-153-0"> x</span><span data-offset-key="3bl4a-154-0">^</span><span data-offset-key="3bl4a-155-0">2</span><span data-offset-key="3bl4a-156-0">.</span></li><li><span data-offset-key="3bl4a-160-0">Choose</span><span data-offset-key="3bl4a-161-0"> an</span><span data-offset-key="3bl4a-162-0"> initial</span><span data-offset-key="3bl4a-163-0"> x</span><span data-offset-key="3bl4a-164-0">-</span><span data-offset-key="3bl4a-165-0">value</span><span data-offset-key="3bl4a-166-0">,</span><span data-offset-key="3bl4a-167-0"> for</span><span data-offset-key="3bl4a-168-0"> example</span><span data-offset-key="3bl4a-169-0">,</span><span data-offset-key="3bl4a-170-0"> x</span><span data-offset-key="3bl4a-171-0">_</span><span data-offset-key="3bl4a-172-0">0</span><span data-offset-key="3bl4a-173-0"> =</span><span data-offset-key="3bl4a-174-0"> 0</span><span data-offset-key="3bl4a-175-0">.</span><span data-offset-key="3bl4a-176-0">3</span><span data-offset-key="3bl4a-177-0">.</span></li><li><span data-offset-key="3bl4a-181-0">Trace</span><span data-offset-key="3bl4a-182-0"> a</span><span data-offset-key="3bl4a-183-0"> line</span><span data-offset-key="3bl4a-184-0"> perpendicular</span><span data-offset-key="3bl4a-185-0"> to</span><span data-offset-key="3bl4a-186-0"> the</span><span data-offset-key="3bl4a-187-0"> x</span><span data-offset-key="3bl4a-188-0">_</span><span data-offset-key="3bl4a-189-0">axis</span><span data-offset-key="3bl4a-190-0"> from</span><span data-offset-key="3bl4a-191-0"> x</span><span data-offset-key="3bl4a-192-0">_</span><span data-offset-key="3bl4a-193-0">n</span><span data-offset-key="3bl4a-194-0"> =</span><span data-offset-key="3bl4a-195-0"> x</span><span data-offset-key="3bl4a-196-0">_</span><span data-offset-key="3bl4a-197-0">0</span><span data-offset-key="3bl4a-198-0"> =</span><span data-offset-key="3bl4a-199-0"> 0</span><span data-offset-key="3bl4a-200-0">.</span><span data-offset-key="3bl4a-201-0">3</span><span data-offset-key="3bl4a-202-0"> in</span><span data-offset-key="3bl4a-203-0"> x</span><span data-offset-key="3bl4a-204-0"> and</span><span data-offset-key="3bl4a-205-0"> 0</span><span data-offset-key="3bl4a-206-0"> in</span><span data-offset-key="3bl4a-207-0"> y</span><span data-offset-key="3bl4a-208-0"> to</span><span data-offset-key="3bl4a-209-0"> y</span><span data-offset-key="3bl4a-210-0"> =</span><span data-offset-key="3bl4a-211-0"> f</span><span data-offset-key="3bl4a-212-0">(</span><span data-offset-key="3bl4a-213-0">x</span><span data-offset-key="3bl4a-214-0">_</span><span data-offset-key="3bl4a-215-0">n</span><span data-offset-key="3bl4a-216-0">)</span><span data-offset-key="3bl4a-217-0"> =</span><span data-offset-key="3bl4a-218-0"> x</span><span data-offset-key="3bl4a-219-0">_</span><span data-offset-key="3bl4a-220-0">n</span><span data-offset-key="3bl4a-221-0">^</span><span data-offset-key="3bl4a-222-0">2</span></li><li><span data-offset-key="3bl4a-226-0">Trace</span><span data-offset-key="3bl4a-227-0"> a</span><span data-offset-key="3bl4a-228-0"> line</span><span data-offset-key="3bl4a-229-0"> parallel</span><span data-offset-key="3bl4a-230-0"> to</span><span data-offset-key="3bl4a-231-0"> the</span><span data-offset-key="3bl4a-232-0"> x</span><span data-offset-key="3bl4a-233-0">_</span><span data-offset-key="3bl4a-234-0">axis</span><span data-offset-key="3bl4a-235-0"> from</span><span data-offset-key="3bl4a-236-0"> 0</span><span data-offset-key="3bl4a-237-0">.</span><span data-offset-key="3bl4a-238-0">3</span><span data-offset-key="3bl4a-239-0"> in</span><span data-offset-key="3bl4a-240-0"> x</span><span data-offset-key="3bl4a-241-0"> and</span><span data-offset-key="3bl4a-242-0"> y</span><span data-offset-key="3bl4a-243-0"> =</span><span data-offset-key="3bl4a-244-0"> f</span><span data-offset-key="3bl4a-245-0">(</span><span data-offset-key="3bl4a-246-0">x</span><span data-offset-key="3bl4a-247-0">_</span><span data-offset-key="3bl4a-248-0">n</span><span data-offset-key="3bl4a-249-0">)</span><span data-offset-key="3bl4a-250-0"> =</span><span data-offset-key="3bl4a-251-0"> x</span><span data-offset-key="3bl4a-252-0">^</span><span data-offset-key="3bl4a-253-0">2</span><span data-offset-key="3bl4a-254-0"> to</span><span data-offset-key="3bl4a-255-0"> x</span><span data-offset-key="3bl4a-256-0"> =</span><span data-offset-key="3bl4a-257-0"> f</span><span data-offset-key="3bl4a-258-0">(</span><span data-offset-key="3bl4a-259-0">x</span><span data-offset-key="3bl4a-260-0">_(</span><span data-offset-key="3bl4a-261-0">n</span><span data-offset-key="3bl4a-262-0">+</span><span data-offset-key="3bl4a-263-0">1</span><span data-offset-key="3bl4a-264-0">))</span><span data-offset-key="3bl4a-265-0"> =</span><span data-offset-key="3bl4a-266-0"> x</span><span data-offset-key="3bl4a-267-0">_(</span><span data-offset-key="3bl4a-268-0">n</span><span data-offset-key="3bl4a-269-0">+</span><span data-offset-key="3bl4a-270-0">1</span><span data-offset-key="3bl4a-271-0">)</span></li><li><span data-offset-key="3bl4a-275-0">Repeat</span><span data-offset-key="3bl4a-276-0"> steps</span><span data-offset-key="3bl4a-277-0"> 3</span><span data-offset-key="3bl4a-278-0"> and</span><span data-offset-key="3bl4a-279-0"> 4</span><span data-offset-key="3bl4a-280-0"> for</span><span data-offset-key="3bl4a-281-0"> following</span><span data-offset-key="3bl4a-282-0"> iter</span><span data-offset-key="3bl4a-283-0">ate</span><span data-offset-key="3bl4a-284-0"> values</span><span data-offset-key="3bl4a-285-0"> up</span><span data-offset-key="3bl4a-286-0"> to</span><span data-offset-key="3bl4a-287-0"> the</span><span data-offset-key="3bl4a-288-0"> desired</span><span data-offset-key="3bl4a-289-0"> x</span><span data-offset-key="3bl4a-290-0">_</span><span data-offset-key="3bl4a-291-0">n</span><span data-offset-key="3bl4a-292-0">.</span></li></ol><h2>Graphical iteration in R with tidyverse</h2><p>This past winter, I wrote a short program in R to produce graphical iteration plots for custom mathematical functions as a tool and fun side-project for a college course on chaos and fractals which I took at College of the Atlantic, in Bar Harbor, ME.</p><p>Although I think of myself usually more as a python programmer, I find R has some great advantages when it comes to plotting thanks to the tidyverse library collection, which includes the excellent ggplot.</p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/graphical-iteration.png" alt="Graphical Iteration plot for the orbits of the function f(x) = -2 * sin(x) + x, given initial conditions 3.6, 4.43, and 7" width="1400" height="865" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical-iteration-xs.png 300w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical-iteration-sm.png 480w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/graphical-iteration-md.png 768w"><figcaption>Graphical iteration plot of the orbits of the function f(x) = <span class="pl-k">-</span><span class="pl-c1">2</span> <span class="pl-k">*</span> sin(<span class="pl-smi">x</span>) <span class="pl-k">+</span> <span class="pl-smi">x, for the initial conditions 3.6, 4.43, and 7. Made using ggplot.</span></figcaption></figure><h2>The program</h2><p>The program is fairly simple. It is composed of several blocks. First, a setup block, in which the user specifies the program settings such as the function to iterate, initial conditions, number of iterations, and the plot window. Then, the block where most of the code lifes, the main body of the program, which is composed of a function to collect plotting data for the user-specified function, a function to collect and return graphical iteration plotting data, and a last function to collect and return time series plotting data according to the program settings. In the final block of this program, we run the functions from the last block with the user-specified setup settings, and plot the graphical iteration and time series orbit plots using the tibbles the functions return.</p><h3 dir="auto">Setup</h3><div class="highlight highlight-source-r position-relative overflow-auto"><pre><span class="pl-c"># set your initial condition and desired number of iterations:</span>
<span class="pl-smi">x_0s</span> <span class="pl-k">&lt;-</span> c(<span class="pl-c1">3.43</span>, <span class="pl-c1">4.43</span>, <span class="pl-c1">7</span>)
<span class="pl-smi">N</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">100</span>

<span class="pl-c"># set the iteration plot x axis range (lower and upper bounds):</span>
<span class="pl-smi">x_min</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">0</span>; <span class="pl-smi">x_max</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">8</span>
<span class="pl-smi">y_min</span> <span class="pl-k">&lt;-</span> <span class="pl-k">-</span><span class="pl-c1">2</span>; <span class="pl-smi">y_max</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">8</span>

<span class="pl-smi">use_custom_range_x</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">FALSE</span>
<span class="pl-smi">use_custom_range_y</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">FALSE</span>

<span class="pl-c"># declare your function here:</span>
<span class="pl-en">func</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>){
  <span class="pl-k">return</span>(<span class="pl-k">-</span><span class="pl-c1">2</span> <span class="pl-k">*</span> sin(<span class="pl-smi">x</span>) <span class="pl-k">+</span> <span class="pl-smi">x</span>) <span class="pl-c"># function goes here</span>
}</pre></div><h3 dir="auto">The nitty-gritty</h3><div class="highlight highlight-source-r position-relative overflow-auto"><pre><span class="pl-en">get_function_data</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-v">range</span> <span class="pl-k">=</span> c(<span class="pl-k">-</span><span class="pl-c1">1</span>, <span class="pl-c1">1</span>), <span class="pl-v">steps</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>){
  
  <span class="pl-smi">steps_multiplier</span> <span class="pl-k">&lt;-</span> (<span class="pl-smi">range</span>[<span class="pl-c1">2</span>]<span class="pl-k">-</span><span class="pl-smi">range</span>[<span class="pl-c1">1</span>])<span class="pl-k">/</span><span class="pl-c1">10</span> 
  <span class="pl-k">if</span>(<span class="pl-smi">steps_multiplier</span> <span class="pl-k">&lt;</span> <span class="pl-c1">1</span>){<span class="pl-smi">steps_multiplier</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">1</span>}
  <span class="pl-c"># adds steps to get data for depending on the number of 10s </span>
  <span class="pl-c"># in the specified plot x range</span>
  
  <span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-smi">range</span>[<span class="pl-c1">1</span>], <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-smi">range</span>[<span class="pl-c1">2</span>], <span class="pl-v">length.out</span> <span class="pl-k">=</span> <span class="pl-smi">steps</span> <span class="pl-k">*</span> <span class="pl-smi">steps_multiplier</span>)
  
  <span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> <span class="pl-k">array</span>(<span class="pl-v">dim</span> <span class="pl-k">=</span> <span class="pl-smi">steps</span> <span class="pl-k">*</span> <span class="pl-smi">steps_multiplier</span>) 
  <span class="pl-k">for</span>(<span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span>length(<span class="pl-smi">x</span>)){
    <span class="pl-smi">y</span>[<span class="pl-smi">i</span>] <span class="pl-k">&lt;-</span> func(<span class="pl-smi">x</span>[<span class="pl-smi">i</span>])
    } 
  
  <span class="pl-k">return</span>(<span class="pl-k">data.frame</span>(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>))
}

<span class="pl-en">graphical_iterator</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">x_0s</span>, <span class="pl-v">N</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>){ 
  
  <span class="pl-smi">segments</span> <span class="pl-k">&lt;-</span> <span class="pl-k">data.frame</span>()
  <span class="pl-k">for</span>(<span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-smi">x_0s</span>){
    
    <span class="pl-smi">start</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">i</span> 
    <span class="pl-smi">vert</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">FALSE</span> 
    
    <span class="pl-smi">x_0</span> <span class="pl-k">&lt;-</span> rep(<span class="pl-smi">i</span>,<span class="pl-v">times</span><span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">+</span>(<span class="pl-smi">N</span><span class="pl-k">*</span><span class="pl-c1">2</span>))
    <span class="pl-smi">xstarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">start</span>)
    <span class="pl-smi">ystarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">y_min</span>)
    <span class="pl-smi">xends</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">start</span>)
    <span class="pl-smi">yends</span> <span class="pl-k">&lt;-</span> c(func(<span class="pl-smi">start</span>))
    
    <span class="pl-c"># iteratively get the coordinates of the next segment points</span>
    <span class="pl-k">for</span>(<span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span>(<span class="pl-c1">2</span> <span class="pl-k">*</span> <span class="pl-smi">N</span>)) 
      <span class="pl-c"># range = 2 * N because every step will be described by two segments</span>
    {
      <span class="pl-c"># if the last segment was vertical, the next must be horizontal</span>
      <span class="pl-k">if</span>(<span class="pl-smi">vert</span>){
        <span class="pl-smi">xstarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">xstarts</span>, <span class="pl-smi">start</span>)
        <span class="pl-smi">ystarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">ystarts</span>, <span class="pl-smi">start</span>)
        <span class="pl-smi">xends</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">xends</span>, <span class="pl-smi">start</span>)
        <span class="pl-smi">yends</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">yends</span>, func(<span class="pl-smi">start</span>)) 
        <span class="pl-smi">vert</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">FALSE</span>
      }
      <span class="pl-k">else</span>{
        <span class="pl-smi">xstarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">xstarts</span>, <span class="pl-smi">start</span>)
        <span class="pl-smi">ystarts</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">ystarts</span>, func(<span class="pl-smi">start</span>)) 
        <span class="pl-smi">xends</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">xends</span>, func(<span class="pl-smi">start</span>)) 
        <span class="pl-smi">yends</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">yends</span>, func(<span class="pl-smi">start</span>)) 
        <span class="pl-smi">vert</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">TRUE</span>
        <span class="pl-smi">start</span> <span class="pl-k">&lt;-</span> func(<span class="pl-smi">start</span>) <span class="pl-c"># update start value</span>
      }
    }
    <span class="pl-smi">segments</span> <span class="pl-k">&lt;-</span> rbind(<span class="pl-smi">segments</span>, <span class="pl-k">data.frame</span>(<span class="pl-v">x_0s</span> <span class="pl-k">=</span> <span class="pl-smi">x_0</span>, <span class="pl-smi">xstarts</span>, <span class="pl-smi">ystarts</span>, <span class="pl-smi">xends</span>, <span class="pl-smi">yends</span>))
  }
  <span class="pl-k">return</span>(<span class="pl-smi">segments</span>)
}

<span class="pl-smi">cobweb_trajects</span> <span class="pl-k">&lt;-</span> graphical_iterator(<span class="pl-v">x_0s</span> <span class="pl-k">=</span> <span class="pl-smi">x_0s</span>, <span class="pl-v">N</span> <span class="pl-k">=</span> <span class="pl-smi">N</span>)

<span class="pl-k">if</span>(<span class="pl-smi">use_custom_range_x</span> <span class="pl-k">==</span> <span class="pl-c1">FALSE</span>){
  <span class="pl-smi">x_min</span> <span class="pl-k">&lt;-</span> min(<span class="pl-smi">cobweb_trajects</span><span class="pl-k">$</span><span class="pl-smi">xstarts</span>); <span class="pl-smi">x_max</span> <span class="pl-k">&lt;-</span> max(<span class="pl-smi">cobweb_trajects</span><span class="pl-k">$</span><span class="pl-smi">xends</span>)
}
<span class="pl-k">if</span>(<span class="pl-smi">use_custom_range_y</span> <span class="pl-k">==</span> <span class="pl-c1">FALSE</span>){
  <span class="pl-smi">y_min</span> <span class="pl-k">&lt;-</span> min(<span class="pl-smi">cobweb_trajects</span><span class="pl-k">$</span><span class="pl-smi">xstarts</span>); <span class="pl-smi">y_max</span> <span class="pl-k">&lt;-</span> max(<span class="pl-smi">cobweb_trajects</span><span class="pl-k">$</span><span class="pl-smi">xends</span>)
}

<span class="pl-smi">plot_data</span> <span class="pl-k">&lt;-</span> get_function_data(<span class="pl-v">range</span> <span class="pl-k">=</span> c(<span class="pl-smi">x_min</span>,<span class="pl-smi">x_max</span>)) <span class="pl-c"># gets the plotting data</span>

<span class="pl-en">get_function_iteration_trajectories</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">x_0s</span>, <span class="pl-v">N</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>){
  
  <span class="pl-smi">trajectories</span> <span class="pl-k">&lt;-</span> <span class="pl-k">data.frame</span>()
  
  <span class="pl-k">for</span>(<span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-smi">x_0s</span>){
    <span class="pl-smi">x_t</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">i</span>
    
    <span class="pl-smi">x_0</span> <span class="pl-k">&lt;-</span> rep(<span class="pl-smi">i</span>,<span class="pl-v">times</span><span class="pl-k">=</span><span class="pl-smi">N</span><span class="pl-k">+</span><span class="pl-c1">1</span>)
    <span class="pl-smi">n</span> <span class="pl-k">&lt;-</span> <span class="pl-c1">0</span><span class="pl-k">:</span><span class="pl-smi">N</span>
    
    <span class="pl-smi">trajectory</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">x_t</span>)
    
    <span class="pl-k">for</span>(<span class="pl-smi">t</span> <span class="pl-k">in</span> <span class="pl-c1">0</span><span class="pl-k">:</span>(<span class="pl-smi">N</span><span class="pl-k">-</span><span class="pl-c1">1</span>)){
      <span class="pl-smi">x_t</span> <span class="pl-k">&lt;-</span> func(<span class="pl-smi">x_t</span>)
      <span class="pl-smi">trajectory</span> <span class="pl-k">&lt;-</span> c(<span class="pl-smi">trajectory</span>, <span class="pl-smi">x_t</span>) <span class="pl-c"># add x_t_1's value to the trajectory vector</span>
    }
    <span class="pl-smi">trajectories</span> <span class="pl-k">&lt;-</span> rbind(<span class="pl-smi">trajectories</span>, <span class="pl-k">data.frame</span>(<span class="pl-v">x_0s</span> <span class="pl-k">=</span> <span class="pl-smi">x_0</span>, <span class="pl-v">ns</span> <span class="pl-k">=</span> <span class="pl-smi">n</span>, <span class="pl-v">trajectories</span> <span class="pl-k">=</span> <span class="pl-smi">trajectory</span>))
  }
  <span class="pl-k">return</span>(<span class="pl-smi">trajectories</span>)
}

<span class="pl-smi">trajectories</span> <span class="pl-k">&lt;-</span> get_function_iteration_trajectories(<span class="pl-v">x_0s</span> <span class="pl-k">=</span> <span class="pl-smi">x_0s</span>, <span class="pl-v">N</span> <span class="pl-k">=</span> <span class="pl-smi">N</span>)</pre><h3 class="zeroclipboard-container position-absolute right-0 top-0"><span style="color: var(--headings-color); font-family: var(--font-base); font-size: 1.60181em; font-weight: var(--font-weight-bold); letter-spacing: var(--letter-spacing);">Plots</span></h3></div><p dir="auto"><strong>Graphical iteration plot:</strong></p><div class="highlight highlight-source-r position-relative overflow-auto"><pre><span class="pl-smi">plot_data</span> %<span class="pl-k">&gt;</span>% 
  ggplot(aes(<span class="pl-smi">x</span>, <span class="pl-smi">y</span>)) <span class="pl-k">+</span>
  geom_line(<span class="pl-v">colour</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span>) <span class="pl-k">+</span>
  geom_abline(<span class="pl-v">linetype</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>dashed<span class="pl-pds">"</span></span>) <span class="pl-k">+</span> 
  geom_segment(<span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">cobweb_trajects</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">xstarts</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">ystarts</span>, <span class="pl-v">xend</span> <span class="pl-k">=</span> <span class="pl-smi">xends</span>, 
                                          <span class="pl-v">yend</span> <span class="pl-k">=</span> <span class="pl-smi">yends</span>, <span class="pl-v">colour</span><span class="pl-k">=</span>as.factor(<span class="pl-smi">x_0s</span>))) <span class="pl-k">+</span>
  coord_cartesian(<span class="pl-v">xlim</span> <span class="pl-k">=</span> c(<span class="pl-smi">x_min</span>, <span class="pl-smi">x_max</span>), <span class="pl-v">ylim</span> <span class="pl-k">=</span> c(<span class="pl-smi">y_min</span>, <span class="pl-smi">y_max</span>)) </pre></div><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/figure1.png" alt="" width="672" height="480" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure1-xs.png 300w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure1-sm.png 480w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure1-md.png 768w"></figure><p><strong>Time-series plot: </strong></p><pre><span class="pl-c"># trajectory plot</span>
<span class="pl-smi">trajectories</span> %<span class="pl-k">&gt;</span>% 
  ggplot(aes(<span class="pl-smi">ns</span>, <span class="pl-smi">trajectories</span>, <span class="pl-v">colour</span> <span class="pl-k">=</span> as.factor(<span class="pl-smi">x_0s</span>))) <span class="pl-k">+</span>
  geom_line() <span class="pl-k">+</span> labs(<span class="pl-v">x</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>n<span class="pl-pds">"</span></span>)</pre><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/figure2.png" alt="" width="672" height="480" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure2-xs.png 300w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure2-sm.png 480w, https://phileasdg.github.io/phileas-dazeley-gaist/media/posts/7/responsive/figure2-md.png 768w"></figure><h2>Closing remarks </h2><p>I hope that this tool might be useful in education settings for demonstration purposes, or for analysis, as the program also produces data frames of the plotting data which contain all the orbit information. I am hopeful that this tool might be useful to undergraduate students. I have seen graphical iteration used in economics courses at the university level, so perhaps this tool could help economists in training, for instance, to model poverty traps.  </p><p>If you are interested in trying this code out for yourself, by far the easiest way is probably to download the original .rmd file from my GitHub, at this link: <a href="https://github.com/phileasdg/Graphical-Iteration-in-R">Graphical iteration in R on GitHub</a> Please feel free to modify it and use it in your projects. The program is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.<a href="https://github.com/phileasdg/Graphical-Iteration-in-R"></a></p></div><footer><p class="post__last-updated">This article was updated on August 12, 2022</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/tags/programming/">Programming</a></li><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/tags/r/">R</a></li><li><a href="https://phileasdg.github.io/phileas-dazeley-gaist/tags/undergraduate-work/">Undergraduate work</a></li></ul><aside class="post__share"></aside></div><div class="post__bio author"><div><h3 class="h6 author__name"><a href="https://phileasdg.github.io/phileas-dazeley-gaist/authors/phileas-dazeley-gaist/" class="invert" title="Phileas Dazeley-Gaist">Phileas Dazeley-Gaist</a></h3></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://phileasdg.github.io/phileas-dazeley-gaist/ai-contemporary-uses-and-questions-for-audiovisual-entertainment/" rel="prev">Previous Post<h3 class="h6">AI: Contemporary uses and questions for Audiovisual Entertainment.</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://phileasdg.github.io/phileas-dazeley-gaist/logistic-model-bifurcation-regressions/" rel="prev">Next Post<h3 class="h6">An Exploration of the Logistic Function using GAMs and Spline Regressions in R</h3></a></div></nav></footer></div></article></div></main><footer class="footer"><div class="footer__social"><a href="https://www.instagram.com/phileasdg/" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://phileasdg.github.io/phileas-dazeley-gaist/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/phileas/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://phileasdg.github.io/phileas-dazeley-gaist/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://www.youtube.com/@phileasdg" aria-label="Youtube" class="youtube"><svg><use xlink:href="https://phileasdg.github.io/phileas-dazeley-gaist/assets/svg/svg-map.svg#youtube"/></svg></a></div><div class="footer__copyright">Phileas Dazeley-Gaist</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://phileasdg.github.io/phileas-dazeley-gaist/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>