<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>A Dynamical Model of Immune-System Response to mRNA, Live Virus, and Inactivated Vaccines - Phileas Dazeley-Gaist</title><meta name="description" content="Note: This post was originally a short technical article I shared on&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-K13VH578CQ"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-K13VH578CQ' );</script><link rel="canonical" href="https://phileasdg.github.io/adawdaw/"><link rel="alternate" type="application/atom+xml" href="https://phileasdg.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://phileasdg.github.io/feed.json"><meta property="og:title" content="A Dynamical Model of Immune-System Response to mRNA, Live Virus, and Inactivated Vaccines"><meta property="og:image" content="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.14.00.png"><meta property="og:image:width" content="1578"><meta property="og:image:height" content="752"><meta property="og:site_name" content="Phileas Dazeley-Gaist"><meta property="og:description" content="Note: This post was originally a short technical article I shared on&hellip;"><meta property="og:url" content="https://phileasdg.github.io//adawdaw/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@phileasdg"><meta name="twitter:title" content="A Dynamical Model of Immune-System Response to mRNA, Live Virus, and Inactivated Vaccines"><meta name="twitter:description" content="Note: This post was originally a short technical article I shared on&hellip;"><meta name="twitter:image" content="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.14.00.png"><link rel="stylesheet" href="https://phileasdg.github.io/assets/css/style.css?v=ff30ce3ac4c3be676e9c9a0dc5db8575"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://phileasdg.github.io/adawdaw/"},"headline":"A Dynamical Model of Immune-System Response to mRNA, Live Virus, and Inactivated Vaccines","datePublished":"2024-05-02T09:44-04:00","dateModified":"2024-12-16T14:41-05:00","image":{"@type":"ImageObject","url":"https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.14.00.png","height":752,"width":1578},"description":"Note: This post was originally a short technical article I shared on&hellip;","author":{"@type":"Person","name":"Phileas Dazeley-Gaist","url":"https://phileasdg.github.io/authors/phileas-dazeley-gaist/"},"publisher":{"@type":"Organization","name":"Phileas Dazeley-Gaist"}}</script><a hidden rel="me" href="https://mathstodon.xyz/@phileasdg">Mastodon</a></head><body><header class="header" id="js-header"><a href="https://phileasdg.github.io/" class="logo">Phileas Dazeley-Gaist</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://phileasdg.github.io/" target="_self">Home</a></li><li><a href="https://phileasdg.github.io/guest-lectures-and-public-speaking-events/" target="_self">Public Speaking</a></li><li><a href="https://phileasdg.github.io/a-few-words-about-me/" target="_self">About</a></li><li><a href="https://phileasdg.github.io/resume-cv/" target="_self">Resume / CV</a></li><li><a href="https://phileasdg.github.io/inquiries/" target="_self">Inquiries</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://phileasdg.github.io/tags/modelling/" class="post__maintag">Modelling</a><h1 class="post__title">A Dynamical Model of Immune-System Response to mRNA, Live Virus, and Inactivated Vaccines</h1><div class="post__meta"><div class="post__author">By <a href="https://phileasdg.github.io/authors/phileas-dazeley-gaist/" class="invert" rel="author" title="Phileas Dazeley-Gaist">Phileas Dazeley-Gaist</a></div><time datetime="2024-05-02T09:44">May 2, 2024</time></div></header><figure class="post__featured-image"><img src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.14.00.png" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.14.00-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.14.00-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.14.00-md.png 768w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.14.00-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="752" width="1578" alt=""></figure><div class="post__inner"><div class="post__entry"><p class="msg msg--info"><strong>Note: </strong>This post was originally a short technical article I shared on the Wolfram Community forums. For an interactive experience with live demonstrations or to download this text and source source code as a Wolfram Notebook, please visit the original post <a href="https://community.wolfram.com/groups/-/m/t/3055726">here</a>. </p><p class="msg msg--highlight"><span class="cc1" data-native-text="true"><strong>Source article:</strong> Zhaobin Xu, Jian Song, Hongmei Zhang, Zhenlin Wei, Dongqing Wei, Jacques Demongeot, A Mathematical Model Simulating the Adaptive Immune Response in Various Vaccines and Vaccination Strategies, medRxiv 2023.10.05.23296578. DOI: </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://doi.org/10.1101/2023.10.05.23296578" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc3" data-native-text="true">https://doi.org/10.1101/2023.10.05.23296578</span></a></p><h2>Introduction:</h2><p><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">The accomplishments of vaccination are numerous, leading to significant advances in human health. Yet new infectious diseases and evolving pathogens constantly challenge our understanding of vaccine efficacy and immunity. Mathematical modelling is a crucial lens through which we can reach a more comprehensive understanding of these complexities. By simulating the biological responses to vaccines, models can provide critical insights into disease progression, vaccine performance, and optimal strategies for developing vaccines.</span></p><div id="cell-fe47751b-0fbc-4ad3-bab0-ee4f1dd22fb8" class="cell"><div class="cell-wrapper"><div class="_3Dqn7hOe5vVS6Nh0S54gcV"> </div><div class="cell-content"><div><div class="native-layout native-layout-simple"><span class="cc6" data-native-text="true">In this short text, we’ll explore an approach to constructing one such model in the Wolfram Language. We will reproduce a compartmental dynamical model of adaptive immune responses to vaccine treatments described in a recent preprint from medRxiv.org: </span><span class="cc14" data-native-text="true">A Mathematical Model Simulating the Adaptive Immune Response in Various Vaccines and Vaccination Strategies</span> <a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://www.medrxiv.org/content/10.1101/2023.10.05.23296578v1" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc9" data-native-text="true">(Xu et al. 2023)</span></a><span class="cc6" data-native-text="true">. Compartmental models are a class of mathematical models which divide variables of interest into sections or “compartments”. Each compartment represents a specific state within the system being studied. The models track how entities, like cells or molecules, interact within and between these compartments over time.</span></div></div></div></div></div><div id="cell-95dd72c5-3543-4f12-a9d7-8486a64fa8f9" class="cell"><div class="cell-wrapper"><div class="_3Dqn7hOe5vVS6Nh0S54gcV"> </div><div class="cell-content"><div class="native-layout native-layout-simple"><span class="cc6" data-native-text="true">The stated goal of the paper is to construct a novel mathematical model to quantitatively research the activation of adaptive immune responses by vaccines. This model is used to simulate and compare the dynamics of antibody levels after administering different types of vaccines (inactivated, attenuated live virus, mRNA), thereby contributing to a better understanding of the mechanisms of various vaccines and vaccination strategies. Through the model, the authors aim to suggest strategies for vaccine design, while providing a comprehensive portrait of the inducible interactions between antibodies and antigens in the immune process.</span></div><h2>Setup</h2><h3>Dependencies</h3><p><span class="cc6" data-native-text="true">We will make use of the </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://resources.wolframcloud.com/PacletRepository/resources/RobertNachbar/CompartmentalModeling/" target="_blank" data-testid="ButtonBoxView" id="aui_3_4_0_1_433" rel="noopener"><span class="cc9" data-native-text="true">CompartmentalModelling</span></a><span class="cc6" data-native-text="true"> paclet. You can install and load the paclet like so:</span></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-09.49.26.png" alt="" width="560" height="178" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-09.49.26-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-09.49.26-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-09.49.26-md.png 768w"></figure><p><span class="cc6" data-native-text="true">You can find documentation for this paclet by following </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://resources.wolframcloud.com/PacletRepository/resources/RobertNachbar/CompartmentalModeling/" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc9" data-native-text="true">this link</span></a><span class="cc6" data-native-text="true">.</span></p><h3>Paper Tables</h3><p>You can find the definitions for the tables of reactions, reaction variables, and reaction parameters in the original version of this post on <a href="https://community.wolfram.com/groups/-/m/t/3055726">Wolfram Community</a>.</p><h2>Reactions, Parameters, and State Variables of the Model</h2><p>The authors of the paper helpfully provide three tables fully specifying the interactions between state variables (components) of the system, as well as model parameters and initial conditions. I have reproduced these tables below. Note that some parameter values and initial conditions depend on the selected vaccine treatment type. More precisely:</p></div><ul><li>The replication rate of viral antigens, described by parameter k_14 should be set to .3 in the case of a simulation of an attenuated live virus vaccine, and 0 otherwise.</li><li>The initial condition of the state variable x_2 (Antigen) should be set to 10^6 for simulation with an inactivated vaccine, 0 with an mRNA vaccine, and 1 for an attenuated live virus vaccine.</li><li>The initial condition of the state variable x_9 <span class="cc6" data-native-text="true"> (mRNA) should be set to 0 for simulation with an inactivated or attenuated live virus vaccine, and 10^6</span><span class="cc6" data-native-text="true"> for and mRNA vaccine.</span></li></ul><p><span class="cc6" data-native-text="true">For a more in depth explanation of these parameters and initial conditions, please refer to </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://www.medrxiv.org/content/10.1101/2023.10.05.23296578v1" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc9" data-native-text="true">the paper</span></a><span class="cc6" data-native-text="true">.</span></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.05.51.png" alt="" width="1266" height="1226" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.05.51-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.05.51-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.05.51-md.png 768w"></figure><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.06.39.png" alt="" width="1330" height="1144" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.39-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.39-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.39-md.png 768w"></figure><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.06.54.png" alt="" width="1330" height="578" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.54-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.54-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.06.54-md.png 768w"></figure><h2>Extracting Model Information</h2><p><span class="cc6" data-native-text="true">We can use tools from the </span><strong><span class="cc39" data-native-text="true">CompartmentalModelling</span></strong><span class="cc6" data-native-text="true"> paclet to extract useful information about the model. For instance, we can use </span><strong><span class="cc39" data-native-text="true">CompartmentalModelGraph</span></strong><span class="cc6" data-native-text="true"> from the CompartmentalModelling paclet to visualise the model’s structure:</span></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.10.06.png" alt="" width="1682" height="840" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.10.06-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.10.06-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.10.06-md.png 768w"></figure><p><span class="cc6" data-native-text="true">The </span><span class="cc39" data-native-text="true">CompartmentalModelling</span><span class="cc6" data-native-text="true"> paclet contains convenient functions to streamline the process of building models. For instance, we can use </span><strong><span class="cc39" data-native-text="true">KineticCompartmentalModel</span></strong><span class="cc6" data-native-text="true"> to generate differential equations for from a list of component transitions (the reactions).</span></p><p><em>Fetch the model data:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.16.18.png" alt="" width="476" height="929" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.16.18-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.16.18-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.16.18-md.png 768w"></figure><p>These data are very useful for quickly building and simulating compartmental models.</p><h2>Numerical Simulations</h2><h3>Preparing Model ODEs</h3><p><span class="cc8" data-native-text="true">Owing to details related to the original code implementation of the model, the authors provide a slightly modified system of ODEs describing the model. This system is reproduced below and numerically approximated using </span><span class="cc42" data-native-text="true">NDSolve</span><span class="cc8" data-native-text="true"> for different vaccine treatments:</span></p><p><em>Reproduce the ODEs from the paper:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.17.43.png" alt="" width="1308" height="484" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.17.43-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.17.43-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.17.43-md.png 768w"></figure><p>Let’s also get some replacement rules to easily convert between the variable names in plain English, and the symbols used in the paper for the model’s system of ODEs.</p><p><em>Plain English variables &lt;--&gt; ODE variables:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.18.28.png" alt="" width="588" height="57" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.18.28-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.18.28-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.18.28-md.png 768w"></figure><h3>Vaccine Treatment Simulations</h3><p>In the paper, the authors model three cases:</p><ol><li>Inactivated Vaccine Simulation</li><li>Attenuated Live Virus Vaccine</li><li>mRNA Vaccine</li></ol><p><span class="cc8" data-native-text="true">These cases are solved numerically in the three following sections. The inactivated vaccine and mRNA vaccines each take two injections, one at one at </span></p><div><div class="lines"><span class="pa ch cc17" data-token-box-id="c2832" data-token-text="t">t</span><span class="pa char cc10" data-token-box-id="c2833" data-token-text="=">=</span><span class="pa ch cc8" data-token-box-id="c2834" data-token-text="0">0</span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">, the other at </span><span class="pa ch cc17" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2841" data-token-text="t">t</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2842" data-token-text="=">=</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2843" data-token-text="50">50</span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">. The attenuated live-virus vaccine takes a single dose at </span><span class="pa ch cc17" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2850" data-token-text="t">t</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2851" data-token-text="=">=</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2852" data-token-text="0">0</span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">. The injection dosage is of </span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">6^</span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">10</span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);"> for all simulations.</span></div><h3>1. Inactivated Vaccine Simulation</h3><p>Model-specific parameters and initial conditions:</p><ul><li><span class="cc8" data-native-text="true">Replication rate of viral antigens: </span>k_<span class="pa char cc19" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2605" data-token-text="14">14</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2607" data-token-text="=">=</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2608" data-token-text="0">0</span></li><li><span class="cc8" data-native-text="true">Antigen = </span>x_<span class="pa char cc19" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2627" data-token-text="2">2</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2629" data-token-text="[">[</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2630" data-token-text="0">0</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2631" data-token-text="]">]</span><span class="cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-native-text="true"> = </span><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">10^6</span></li><li><span class="cc8" data-native-text="true">mRNA = </span>x_9[<span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2664" data-token-text="0">0</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2665" data-token-text="]">]</span><span class="cc8" data-native-text="true"> = 0</span></li></ul><p><em>Define model parameters corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.21.55.png" alt="" width="1484" height="186" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.21.55-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.21.55-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.21.55-md.png 768w"></figure><p><em>Define initial conditions of the system corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.22.21.png" alt="" width="1414" height="632" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.21-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.21-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.21-md.png 768w"></figure><p><em>Construct the system of equations for NDSolve, with parameter values and initial conditions:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.22.40.png" alt="" width="599" height="29" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.40-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.40-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.22.40-md.png 768w"></figure><p><em><span class="cc25" data-native-text="true">Solve numerically with NDSolve, from </span></em><span class="pa ch cc47" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2737" data-token-text="t">t</span><span class="pa char cc27" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2738" data-token-text="=">=</span><span class="pa ch cc25" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2739" data-token-text="0">0</span><em><span class="cc25" data-native-text="true"> to </span></em><span class="pa ch cc47" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2746" data-token-text="t">t</span><span class="pa char cc27" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2747" data-token-text="=">=</span><span class="pa ch cc25" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2748" data-token-text="100">100</span><em><span class="cc25" data-native-text="true">:</span></em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.23.23.png" alt="" width="485" height="29" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.23-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.23-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.23-md.png 768w"></figure><p><em>Plot the solution:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.23.50.png" alt="" width="1448" height="642" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.50-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.50-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.23.50-md.png 768w"></figure><h3>2. Attenuated Live Virus Vaccine</h3><p>Model-specific parameters and initial conditions:</p><ul><li><span class="cc8" data-native-text="true">Replication rate of viral antigens: </span>k_<span class="pa char cc19" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2605" data-token-text="14">14</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2607" data-token-text="=">=</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2608" data-token-text="0">0.3</span></li><li><span class="cc8" data-native-text="true">Antigen = </span>x_<span class="pa char cc19" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2627" data-token-text="2">2</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2629" data-token-text="[">[</span><span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2630" data-token-text="0">0</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2631" data-token-text="]">]</span><span class="cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-native-text="true"> = 1</span></li><li><span class="cc8" data-native-text="true">mRNA = </span>x_9[<span class="pa ch cc8" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2664" data-token-text="0">0</span><span class="pa char cc10" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2665" data-token-text="]">]</span><span class="cc8" data-native-text="true"> = 0</span></li></ul><p><em>Define model parameters corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.25.32.png" alt="" width="1484" height="194" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.32-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.32-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.32-md.png 768w"></figure><p><em>Define initial conditions of the system corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.25.49.png" alt="" width="1402" height="638" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.49-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.49-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.25.49-md.png 768w"></figure><p><em>Construct the system of equations for NDSolve, with parameter values and initial conditions:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.26.00.png" alt="" width="378" height="35" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.00-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.00-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.00-md.png 768w"></figure><p><em><span class="cc25" data-native-text="true">Solve numerically with NDSolve, from </span></em><span class="pa ch cc47" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2737" data-token-text="t">t</span><span class="pa char cc27" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2738" data-token-text="=">=</span><span class="pa ch cc25" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2739" data-token-text="0">0</span><em><span class="cc25" data-native-text="true"> to </span></em><span class="pa ch cc47" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2746" data-token-text="t">t</span><span class="pa char cc27" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2747" data-token-text="=">=</span><span class="pa ch cc25" style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);" data-token-box-id="c2748" data-token-text="100">100</span><em><span class="cc25" data-native-text="true">:</span></em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.26.19.png" alt="" width="494" height="38" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.19-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.19-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.19-md.png 768w"></figure><p><em>Plot the solution:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.26.44.png" alt="" width="1478" height="646" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.44-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.44-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.26.44-md.png 768w"></figure><h3>3. mRNA Vaccine</h3><p>Model-specific parameters and initial conditions:<br><br>Replication rate of viral antigens: k_14=0<br>Antigen = x_2[0] = 0<br>mRNA = x_9[0] = 10^6</p><p><em>Define model parameters corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.30.46.png" alt="" width="1492" height="206" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.30.46-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.30.46-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.30.46-md.png 768w"></figure><p><em>Define initial conditions of the system corresponding to the inactivated vaccine setup:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.31.19.png" alt="" width="1398" height="646" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.19-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.19-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.19-md.png 768w"></figure><p><em>Construct the system of equations for NDSolve, with parameter values and initial conditions:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.31.32.png" alt="" width="649" height="37" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.32-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.32-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.32-md.png 768w"></figure><p><em>Solve numerically with NDSolve, from t=0 to t=100:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.31.48.png" alt="" width="519" height="37" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.48-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.48-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.31.48-md.png 768w"></figure><p><em>Plot the solution:</em></p><figure class="post__image"><img loading="lazy" src="https://phileasdg.github.io/media/posts/35/Screenshot-2024-05-02-at-10.32.06.png" alt="" width="1460" height="646" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.32.06-xs.png 300w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.32.06-sm.png 480w, https://phileasdg.github.io/media/posts/35/responsive/Screenshot-2024-05-02-at-10.32.06-md.png 768w"></figure><h2>Closing Notes</h2><div id="cell-54b896b0-0f0b-4cac-9367-cb44dc59b1b4" class="cell"><div class="cell-wrapper"><div class="cell-content"><div><div> </div><div class="native-layout native-layout-simple"><span class="cc8" data-native-text="true">Through the exploration of this dynamical immune response model, we have seen how mathematical modelling in the Wolfram Language, can be used to derive insights into complex biological systems.</span></div></div></div></div></div><div id="cell-952802b4-cfde-45ea-bf61-c9cfcec97f25" class="cell"><div class="cell-wrapper"><div class="_3Dqn7hOe5vVS6Nh0S54gcV"> </div><div class="cell-content"><div><div class="native-layout native-layout-simple"><span class="cc8" data-native-text="true">If you are interested in this work, and would like to learn more, please make sure to give the </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://www.medrxiv.org/content/10.1101/2023.10.05.23296578v1" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc11" data-native-text="true">source paper </span></a><span class="cc8" data-native-text="true">a read! I primarily intend this post to demonstrate how one might conduct this form of modelling in the Wolfram Language. I also highly encourage you to try Bob Nachbar’s </span><a class="GsEf0r4HiEK6fH_vutb_b EEKKPz0N2Ww3GdmB51Zgq" href="https://resources.wolframcloud.com/PacletRepository/resources/RobertNachbar/CompartmentalModeling/" target="_blank" data-testid="ButtonBoxView" rel="noopener"><span class="cc61" data-native-text="true">CompartmentalModelling</span></a><span class="cc8" data-native-text="true"> paclet. The </span><span class="cc42" data-native-text="true">CompartmentalModelling</span><span class="cc8" data-native-text="true"> paclet is not just for biologists, but could be a valuable tool for anyone dealing with interconnected systems that can be represented as compartments. </span></div></div></div></div></div></div></div></div></div><footer><p class="post__last-updated">This article was updated on December 16, 2024</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://phileasdg.github.io/tags/mathematica/">Mathematica</a></li><li><a href="https://phileasdg.github.io/tags/modelling/">Modelling</a></li><li><a href="https://phileasdg.github.io/tags/programming/">Programming</a></li><li><a href="https://phileasdg.github.io/tags/wolfram-language/">Wolfram Language</a></li><li><a href="https://phileasdg.github.io/tags/work-at-wolfram/">Work at Wolfram</a></li></ul><aside class="post__share"></aside></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://phileasdg.github.io/lotka-volterra-models-in-the-wolfram-language/" rel="prev">Previous Post<h3 class="h6">Lotka-Volterra Models in the Wolfram Language</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://phileasdg.github.io/a-forest-fire-model-in-1-2-and-3-dimensions/" rel="prev">Next Post<h3 class="h6">A Forest Fire Model in 1, 2, and 3 Dimensions</h3></a></div></nav></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://phileasdg.github.io/a-forest-fire-model-in-1-2-and-3-dimensions/" class="c-card__image"><img src="https://phileasdg.github.io/media/posts/36/Animation1.gif" loading="lazy" height="834" width="1100" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://phileasdg.github.io/tags/modelling/">Modelling</a></div><h3 class="c-card__title"><a href="https://phileasdg.github.io/a-forest-fire-model-in-1-2-and-3-dimensions/" class="invert">A Forest Fire Model in 1, 2, and 3 Dimensions</a></h3></header><footer class="c-card__meta"><time datetime="2024-05-03T17:38">May 3, 2024</time></footer></div></article><article class="c-card"><a href="https://phileasdg.github.io/lotka-volterra-models-in-the-wolfram-language/" class="c-card__image"><img src="https://phileasdg.github.io/media/posts/32/Screenshot-2023-10-11-at-00.12.50.png" srcset="https://phileasdg.github.io/media/posts/32/responsive/Screenshot-2023-10-11-at-00.12.50-xs.png 300w, https://phileasdg.github.io/media/posts/32/responsive/Screenshot-2023-10-11-at-00.12.50-sm.png 480w, https://phileasdg.github.io/media/posts/32/responsive/Screenshot-2023-10-11-at-00.12.50-md.png 768w, https://phileasdg.github.io/media/posts/32/responsive/Screenshot-2023-10-11-at-00.12.50-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="810" width="2394" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://phileasdg.github.io/tags/ecology/">Ecology</a></div><h3 class="c-card__title"><a href="https://phileasdg.github.io/lotka-volterra-models-in-the-wolfram-language/" class="invert">Lotka-Volterra Models in the Wolfram Language</a></h3></header><footer class="c-card__meta"><time datetime="2023-10-10T14:21">October 10, 2023</time></footer></div></article><article class="c-card"><a href="https://phileasdg.github.io/tracking-icebergs/" class="c-card__image"><img src="https://phileasdg.github.io/media/posts/8/Iceberg_Ilulissat.jpg" srcset="https://phileasdg.github.io/media/posts/8/responsive/Iceberg_Ilulissat-xs.jpg 300w, https://phileasdg.github.io/media/posts/8/responsive/Iceberg_Ilulissat-sm.jpg 480w, https://phileasdg.github.io/media/posts/8/responsive/Iceberg_Ilulissat-md.jpg 768w, https://phileasdg.github.io/media/posts/8/responsive/Iceberg_Ilulissat-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="526" width="768" alt="CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid&#x3D;730855"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://phileasdg.github.io/tags/environmental-science/">Environmental Science</a></div><h3 class="c-card__title"><a href="https://phileasdg.github.io/tracking-icebergs/" class="invert">Tracking Icebergs: Exploring the Mathematics of Iceberg Drift and Decay Models</a></h3></header><footer class="c-card__meta"><time datetime="2022-08-12T08:15">August 12, 2022</time></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://www.instagram.com/phileasdg/" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://phileasdg.github.io/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/phileas/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://phileasdg.github.io/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://www.youtube.com/@phileasdg" aria-label="Youtube" class="youtube"><svg><use xlink:href="https://phileasdg.github.io/assets/svg/svg-map.svg#youtube"/></svg></a></div><div class="footer__copyright">Phileas Dazeley-Gaist</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://phileasdg.github.io/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>